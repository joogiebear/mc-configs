---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';
import ConfigCard from '../components/ConfigCard.astro';

const configs = await getCollection('configs');

// Sort by lastUpdated (most recent first)
configs.sort((a, b) => b.data.lastUpdated.getTime() - a.data.lastUpdated.getTime());
---

<Layout title="Home">
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-white">Minecraft Plugin Configs</h1>
    <p class="mt-2 text-zinc-400">
      Browse and download optimized configurations for popular Minecraft plugins.
    </p>
  </div>

  {configs.length > 0 ? (
    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
      {configs.map((config) => (
        <ConfigCard
          slug={config.id}
          title={config.data.title}
          plugin={config.data.plugin}
          version={config.data.version}
          minecraftVersion={config.data.minecraftVersion}
          description={config.data.description}
          lastUpdated={config.data.lastUpdated}
          fileCount={config.data.files.length}
        />
      ))}
    </div>
  ) : (
    <div class="rounded-lg border border-zinc-800 bg-zinc-800/50 p-12 text-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-12 w-12 text-zinc-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
      </svg>
      <h3 class="mt-4 text-lg font-medium text-zinc-300">No configs yet</h3>
      <p class="mt-2 text-sm text-zinc-500">Check back soon for new configurations!</p>
    </div>
  )}
</Layout>
